<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Meta Service</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --bg-color: #fafafa; --white: #ffffff; --border: #dbdbdb; --text-main: #262626; --blue: #0095f6; }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif; background-color: var(--white); height: 100vh; width: 100vw; overflow: hidden; }

        #app-container { width: 100%; height: 100%; display: flex; flex-direction: column; }

        /* --- LOGIN --- */
        #login-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--white); z-index: 1000; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 40px; }
        .logo { font-size: 2.8rem; font-weight: bold; margin-bottom: 30px; }
        input { width: 100%; max-width: 350px; padding: 14px; border: 1px solid var(--border); border-radius: 8px; margin-bottom: 12px; }
        .login-btn { width: 100%; max-width: 350px; background: var(--blue); color: white; padding: 12px; border: none; border-radius: 8px; font-weight: bold; }

        /* --- APP STRUCTURE --- */
        #main-app { display: none; flex-direction: column; height: 100%; width: 100%; }
        
        header { 
            height: calc(60px + env(safe-area-inset-top)); 
            padding-top: env(safe-area-inset-top);
            border-bottom: 1px solid var(--border); 
            display: flex; justify-content: center; align-items: center; 
            font-weight: bold; flex-shrink: 0; background: var(--white); z-index: 10; 
        }

        .content-area { flex: 1; position: relative; overflow: hidden; }
        
        /* --- FEED CORRIGÉ (PLUS DE BORDURES NOIRES) --- */
        #feed-section { height: 100%; overflow-y: auto; background: var(--bg-color); }
        .post { background: var(--white); margin-bottom: 15px; border-bottom: 1px solid var(--border); margin-left: auto; margin-right: auto; max-width: 600px; }
        .post-img-container { background: #eee; display: flex; justify-content: center; }
        .post-img-container img { 
            width: 100%; 
            max-height: 70vh; 
            display: block; 
            object-fit: cover; /* REMPLACÉ contain PAR cover POUR REMPLIR SANS BORDURE */
        }
        .post-caption { padding: 12px; font-size: 0.95rem; }

        /* --- VIDEOS (TIKTOK STYLE) --- */
        #videos-section { 
            height: 100%; 
            width: 100%;
            overflow-y: scroll; 
            scroll-snap-type: y mandatory; 
            background: #000; 
            display: none;
            scrollbar-width: none;
        }
        #videos-section::-webkit-scrollbar { display: none; }
        #videos-section.active { display: block; }
        
        .video-card { 
            height: 100%; 
            width: 100%;
            scroll-snap-align: start;
            scroll-snap-stop: always;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .video-card video { width: 100%; height: 100%; object-fit: contain; }
        
        .video-info { 
            position: absolute; 
            bottom: calc(40px + env(safe-area-inset-bottom)); 
            left: 15px; color: white; 
            text-shadow: 1px 1px 5px rgba(0,0,0,0.8); 
        }

        /* --- NAV iOS 26 SAFE --- */
        nav { 
            height: calc(85px + env(safe-area-inset-bottom)); 
            padding-bottom: calc(20px + env(safe-area-inset-bottom)); 
            border-top: 1px solid var(--border); 
            display: flex; justify-content: space-around; 
            align-items: center; background: var(--white); 
            z-index: 100;
        }
        nav i { font-size: 1.6rem; color: #8e8e8e; cursor: pointer; padding: 10px; }
        nav i.active { color: var(--text-main); }
    </style>
</head>
<body>

<div id="app-container">
    <div id="login-screen">
        <div class="logo">Meta Service</div>
        <input type="text" id="username" placeholder="Nom d'utilisateur">
        <input type="password" id="password" placeholder="Mot de passe">
        <button class="login-btn" onclick="handleLogin()">Se connecter</button>
    </div>

    <div id="main-app">
        <header id="top-header">Meta Service</header>
        <div class="content-area">
            
            <div id="feed-section" class="section active">
                <div id="photo-list"></div>
            </div>

            <div id="videos-section" class="section">
                <div id="video-list" style="height: 100%;"></div>
            </div>

            <div id="profile-section" class="section" style="padding: 20px; text-align: center; display:none;">
                <h2 id="display-user"></h2>
                <button onclick="handleLogout()" style="margin-top:20px; color:red; border:none; background:none; font-weight:bold;">Déconnexion</button>
            </div>

        </div>
        <nav>
            <i class="fas fa-home active" id="nav-feed" onclick="switchTab('feed')"></i>
            <i class="fas fa-play" id="nav-videos" onclick="switchTab('videos')"></i>
            <i class="fas fa-user" id="nav-profile" onclick="switchTab('profile')"></i>
        </nav>
    </div>
</div>

<script>
    const LISTE_PHOTOS = [
        { url: "https://picsum.photos/800/1200?random=1", auteur: "mazine2.0", bio: "Plus de bordures noires ici !" },
        { url: "https://picsum.photos/800/600?random=2", auteur: "amineg", bio: "L'image remplit bien le cadre." }
    ];

    const LISTE_VIDEOS = [
        { url: "https://www.w3schools.com/html/mov_bbb.mp4", auteur: "mazine2.0", legende: "Vidéo TikTok 1" },
        { url: "https://www.w3schools.com/html/movie.mp4", auteur: "amineg", legende: "Vidéo TikTok 2" }
    ];

    const USERS = { "walid_hchm": "Walid.123", "mazine2.0": "Mazine.123", "amineg": "Amine.123", "user": "12345" };

    function genererContenu() {
        const photoDiv = document.getElementById('photo-list');
        const videoDiv = document.getElementById('video-list');
        photoDiv.innerHTML = ""; videoDiv.innerHTML = "";

        LISTE_PHOTOS.forEach(photo => {
            photoDiv.innerHTML += `<div class="post">
                <div class="post-header" style="padding:10px; font-weight:bold;">${photo.auteur}</div>
                <div class="post-img-container"><img src="${photo.url}"></div>
                <div class="post-caption"><b>${photo.auteur}</b> ${photo.bio}</div>
            </div>`;
        });

        LISTE_VIDEOS.forEach(vid => {
            videoDiv.innerHTML += `<div class="video-card">
                <video loop playsinline muted><source src="${vid.url}" type="video/mp4"></video>
                <div class="video-info"><h3>@${vid.auteur}</h3><p>${vid.legende}</p></div>
            </div>`;
        });
        initVideoObserver();
    }

    function initVideoObserver() {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                const video = entry.target.querySelector('video');
                if (entry.isIntersecting) video.play().catch(() => {});
                else { video.pause(); video.currentTime = 0; }
            });
        }, { threshold: 0.8 });
        document.querySelectorAll('.video-card').forEach(card => observer.observe(card));
    }

    function handleLogin() {
        const u = document.getElementById("username").value.trim().toLowerCase();
        const p = document.getElementById("password").value;
        if (USERS[u] && USERS[u] === p) {
            localStorage.setItem("metaUser", u);
            startApp(u);
        } else alert("Erreur identifiants");
    }

    function startApp(user) {
        document.getElementById("login-screen").style.display = "none";
        document.getElementById("main-app").style.display = "flex";
        document.getElementById("display-user").innerText = user;
        genererContenu();
    }

    function switchTab(tab) {
        document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
        document.querySelectorAll('nav i').forEach(i => i.classList.remove('active'));
        const target = document.getElementById(tab + '-section');
        target.style.display = 'block';
        document.getElementById('nav-' + tab).classList.add('active');
        if(tab === 'videos') {
            document.getElementById('top-header').style.display = "none";
        } else {
            document.getElementById('top-header').style.display = "flex";
            document.querySelectorAll('video').forEach(v => { v.pause(); v.currentTime = 0; });
        }
    }

    function handleLogout() {
        localStorage.removeItem("metaUser");
        location.reload();
    }

    document.addEventListener("DOMContentLoaded", () => {
        const saved = localStorage.getItem("metaUser");
        if(saved) startApp(saved);
    });
</script>
</body>
</html>
